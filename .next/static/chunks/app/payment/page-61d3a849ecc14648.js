(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[407],{22:(e,s,a)=>{"use strict";a.d(s,{Ay:()=>i,iD:()=>n,ri:()=>l});let r=(0,a(8943).Z0)({name:"auth",initialState:{isLoggedIn:!1,user:null},reducers:{login:(e,s)=>{e.isLoggedIn=!0,e.user=s.payload},logout:e=>{e.isLoggedIn=!1,e.user=null}}}),{login:n,updateUser:t,logout:l}=r.actions,i=r.reducer},634:(e,s,a)=>{Promise.resolve().then(a.bind(a,3571))},2428:()=>{},3435:(e,s,a)=>{"use strict";a.d(s,{k5:()=>d});var r=a(2115),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},t=r.createContext&&r.createContext(n),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function o(e,s){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function c(e){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?o(Object(a),!0).forEach(function(s){var r,n,t;r=e,n=s,t=a[s],(n=function(e){var s=function(e,s){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,s||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(e)}(e,"string");return"symbol"==typeof s?s:s+""}(n))in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function d(e){return s=>r.createElement(m,i({attr:c({},e.attr)},s),function e(s){return s&&s.map((s,a)=>r.createElement(s.tag,c({key:a},s.attr),e(s.child)))}(e.child))}function m(e){var s=s=>{var a,{attr:n,size:t,title:o}=e,d=function(e,s){if(null==e)return{};var a,r,n=function(e,s){if(null==e)return{};var a={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(s.indexOf(r)>=0)continue;a[r]=e[r]}return a}(e,s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)a=t[r],!(s.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,l),m=t||s.size||"1em";return s.className&&(a=s.className),e.className&&(a=(a?a+" ":"")+e.className),r.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,n,d,{className:a,style:c(c({color:e.color||s.color},s.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),o&&r.createElement("title",null,o),e.children)};return void 0!==t?r.createElement(t.Consumer,null,e=>s(e)):s(n)}},3571:(e,s,a)=>{"use strict";a.d(s,{default:()=>h});var r=a(5155),n=a(2115),t=a(1536),l=a(648);a(2428);var i=a(3391),o=a(6046),c=a(1665),d=a(5829),m=a(9208),u=a(22);let h=()=>{let e=(0,o.useRouter)(),s=(0,i.wA)(),a=(0,i.d4)(e=>e.booking.bookingData),{isLoggedIn:h}=(0,i.d4)(e=>e.auth),[p,v]=(0,n.useState)(!1),[j,g]=(0,n.useState)(!1),[b,x]=(0,n.useState)({username:"",email:"",phone:""});if((0,n.useEffect)(()=>{if(null==a)e.push("/");else{let e=m.A.get("accessToken");if(e){let s=(0,d.oL)(e);s&&x({username:s.userName||"",email:s.email||"",phone:s.phone||""})}}},[a,e]),null==a)return null;let y=async()=>{try{g(!0);let r=parseFloat(a.distance.replace(/[^\d.-]/g,"")),n={...a,distance:r,passengerName:b.username,passengerEmail:b.email,passengerPhone:b.phone};await (0,d.sH)(n),s((0,u.iD)({email:b.email,userName:b.username,phone:b.phone})),c.oR.success("Booking Created Successfully!"),e.push("/mybooking")}catch(e){console.error("Error processing payment:",e),c.oR.error("Failed to process payment."),g(!1)}};return(0,r.jsx)("div",{className:"payment-container",children:(0,r.jsxs)("div",{className:"payment-wrapper",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h2",{children:"Passenger Details"})}),(0,r.jsx)("div",{className:"card-content",children:(0,r.jsxs)("div",{className:"passenger-details",children:[(0,r.jsxs)("div",{className:"passenger-field",children:[(0,r.jsx)("label",{htmlFor:"username",children:"Passenger"}),(0,r.jsx)("input",{type:"text",id:"username",value:null==b?void 0:b.username,onChange:e=>{x(s=>({...s,username:e.target.value}))},className:"passenger-input",placeholder:"Enter your name",autoFocus:!0})]}),(0,r.jsxs)("div",{className:"passenger-field",children:[(0,r.jsx)("label",{htmlFor:"email",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",value:null==b?void 0:b.email,onChange:e=>{x(s=>({...s,email:e.target.value}))},className:"passenger-input",placeholder:"Enter your email",disabled:h})]}),(0,r.jsxs)("div",{className:"passenger-field",children:[(0,r.jsx)("label",{htmlFor:"phone",children:"Phone"}),(0,r.jsx)("input",{type:"text",id:"phone",value:null==b?void 0:b.phone,onChange:e=>{x(s=>({...s,phone:e.target.value}))},className:"passenger-input",placeholder:"Enter your phone number",disabled:h})]})]})})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h2",{children:"Booking Summary"})}),(0,r.jsxs)("div",{className:"card-content",children:[(0,r.jsxs)("div",{className:"booking-grid",children:[(0,r.jsxs)("div",{className:"booking-item",children:[(0,r.jsx)("div",{className:"booking-label",children:"From"}),(0,r.jsx)("div",{className:"booking-value",children:a.fromLocation})]}),(0,r.jsxs)("div",{className:"booking-item",children:[(0,r.jsx)("div",{className:"booking-label",children:"To"}),(0,r.jsx)("div",{className:"booking-value",children:a.toLocation})]}),(0,r.jsxs)("div",{className:"booking-item",children:[(0,r.jsx)("div",{className:"booking-label",children:"Date"}),(0,r.jsx)("div",{className:"booking-value",children:a.bookingDate})]}),(0,r.jsxs)("div",{className:"booking-item",children:[(0,r.jsx)("div",{className:"booking-label",children:"Time"}),(0,r.jsx)("div",{className:"booking-value",children:a.bookingTime})]}),a.returnDate&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"booking-item",children:[(0,r.jsx)("div",{className:"booking-label",children:"Return Date"}),(0,r.jsx)("div",{className:"booking-value",children:a.returnDate})]}),(0,r.jsxs)("div",{className:"booking-item",children:[(0,r.jsx)("div",{className:"booking-label",children:"Return Time"}),(0,r.jsx)("div",{className:"booking-value",children:a.returnTime})]})]})]}),(0,r.jsx)("div",{className:"separator"}),(0,r.jsxs)("div",{className:"summary-details",children:[(0,r.jsxs)("div",{className:"summary-row",children:[(0,r.jsx)("span",{className:"label",children:"Vehicle"}),(0,r.jsx)("span",{children:a.vehicleName})]}),(0,r.jsxs)("div",{className:"summary-row",children:[(0,r.jsx)("span",{className:"label",children:"Distance"}),(0,r.jsx)("span",{children:a.distance})]}),(0,r.jsxs)("div",{className:"summary-row",children:[(0,r.jsx)("span",{className:"label",children:"Travel Duration"}),(0,r.jsx)("span",{children:a.travelDuration})]}),(0,r.jsxs)("div",{className:"summary-row",children:[(0,r.jsx)("span",{className:"label",children:"Passengers"}),(0,r.jsx)("span",{children:a.passengerCount})]}),(0,r.jsxs)("div",{className:"summary-row",children:[(0,r.jsx)("span",{className:"label",children:"Luggage"}),(0,r.jsx)("span",{children:a.luggageCount})]})]}),(0,r.jsx)("div",{className:"separator"}),(0,r.jsxs)("div",{className:"total-row",children:[(0,r.jsx)("span",{children:"Total Amount"}),(0,r.jsxs)("span",{children:["$",a.totalFare]})]})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h2",{children:"Select Payment Method"})}),(0,r.jsxs)("div",{className:"card-content",children:[(0,r.jsxs)("div",{className:"payment-methods",children:[(0,r.jsxs)("div",{className:"payment-method-option disabled",children:[(0,r.jsx)("input",{type:"radio",className:"payment-method-radio",disabled:!0}),(0,r.jsxs)("div",{className:"payment-method-label",children:[(0,r.jsx)(t.x1c,{className:"icon"}),(0,r.jsx)("span",{children:"Credit/Debit Card (Disabled)"})]})]}),(0,r.jsxs)("div",{className:"payment-method-option selected",children:[(0,r.jsx)("input",{type:"radio",className:"payment-method-radio",checked:!0,readOnly:!0}),(0,r.jsxs)("div",{className:"payment-method-label",children:[(0,r.jsx)(t.lcY,{className:"icon"}),(0,r.jsx)("span",{children:"Cash Payment"})]})]})]}),p?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"confirmation-message",children:"Please confirm your cash payment on delivery"}),(0,r.jsx)("button",{className:"button button-primary",onClick:y,disabled:j,children:j?"Processing...":"Confirm Payment"}),(0,r.jsx)("button",{className:"button button-outline",onClick:()=>v(!1),disabled:j,children:"Back"})]}):(0,r.jsxs)("button",{className:"button button-primary",onClick:()=>{v(!0)},children:["Continue to Payment",(0,r.jsx)(l.xVu,{})]})]})]})]})})}},5829:(e,s,a)=>{"use strict";a.d(s,{Yq:()=>l,fU:()=>i,oL:()=>o,sH:()=>c}),a(3691);var r=a(2922),n=a(9208),t=a(2651);let l=e=>new Date(e).toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"}).replace(/ /g," ").replace(",",""),i=e=>{let[s,a]=e.split(":");return"".concat(s,":").concat(a)},o=e=>{try{return(0,r.s)(e)}catch(e){return console.error("Invalid token:",e),null}},c=async e=>{let s,a,r;let l=n.A.get("accessToken");if(l){let e=o(l);if(!e)throw Error("Failed to decode token");s=e.email,a=e.phone,r=e.userName}else s=e.passengerEmail,a=e.passengerPhone,r=e.passengerName;let i={phone:a,subject:"Booking Confirmation",bookingDetails:e,userEmail:s,userName:r};try{let s=await t.A.post("https://api.urido.co.uk/booking/create",e,{withCredentials:!0});return s.data.data.accessToken&&n.A.set("accessToken",s.data.data.accessToken,{expires:1,secure:!0}),await t.A.post("/frontend-api/sendBookingEmail",i,{withCredentials:!0}),s}catch(e){var c,d;throw console.error("Error in createBooking:",e),(null===(d=e.response)||void 0===d?void 0:null===(c=d.data)||void 0===c?void 0:c.message)||e.message}}}},e=>{var s=s=>e(e.s=s);e.O(0,[589,586,711,479,651,790,46,441,587,358],()=>s(634)),_N_E=e.O()}]);